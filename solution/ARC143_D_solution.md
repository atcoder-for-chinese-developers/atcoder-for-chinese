我们先把 $(A_i,B_i)$ 看做一条边，建出无向图。

不难发现，在这张新图中每一个边双连通分量，都可以通过一个哈密顿环在对应图中构造出环。而新图中的桥，在原图中一定是桥。

所以我们只要把这张无向图中每个边双里构造出环。

如果找到哈密顿环，那么构造方法就是：所有边都选 $u\to v+N$， $(u,v)$ 是哈密顿环上的一条边。

不一定要找到哈密顿环，只要分成一个个小环。

可以直接 dfs，按 dfs 到的顺序连边即可（可以看代码），不难发现，这样可以让所有 dfs 树的叶子结点连到一条回根的路径上。

具体实现可以维护一个 `ansx[i]`，表示这条边从什么点出发（从 $A_i$ 还是 $B_i$）。

[代码](https://atcoder.jp/contests/arc143/submissions/35636732)

(-- by cjn)
