考虑这棵无根树的一个叶子，如果这个叶子是白色朝上，那么它必须在唯一的它连向的点之前操作，不然它就没有机会变成白色；如果是黑色朝上，那么它必须在唯一的它连向的点之后操作。

可以拓扑排序，设 $f_i$ 表示这个点在拓扑排序中是叶子时，是黑色还是白色。

删掉一个点后，将其连向的那个点的颜色翻转。

如果只剩下最后一个点，并且 $f_i$ 是黑色，那么 G 了。

现在问题转化为：构造一个排列，有一些限制，形如：$x$ 在 $y$ 之前/后出现。你需要使其字典序最小。

用一个堆来拓扑排序即可。

[代码](https://atcoder.jp/contests/arc143/submissions/35719422)

(-- by cjn)
